<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>openwrt on 点滴随记</title>
        <link>https://jimway71.github.io/tags/openwrt/</link>
        <description>Recent content in openwrt on 点滴随记</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <lastBuildDate>Mon, 15 Aug 2022 23:33:00 +0800</lastBuildDate><atom:link href="https://jimway71.github.io/tags/openwrt/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>临时记录</title>
        <link>https://jimway71.github.io/p/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/</link>
        <pubDate>Mon, 15 Aug 2022 23:33:00 +0800</pubDate>
        
        <guid>https://jimway71.github.io/p/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/</guid>
        <description>&lt;img src="https://jimway71.github.io/wallpaper/wallpaper-19.jpg" alt="Featured image of post 临时记录" /&gt;&lt;h2 id=&#34;openwrt&#34;&gt;OpenWrt:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/qq_38892883/article/details/79551504&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Openwrt通用固件make menuconfig配置&lt;/a&gt;:&lt;br&gt;
2018-03-14 12:10:35 发布&lt;br&gt;
内容: OpenWrt的make menuconfig详细配置&lt;br&gt;
包括:&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;blockquote&gt;
&lt;p&gt;Target System &amp;mdash;&amp;gt;&lt;br&gt;
Target Profile &amp;mdash;&amp;gt;&lt;br&gt;
LuCI &amp;mdash;&amp;gt; Collections&lt;br&gt;
LuCI &amp;mdash;&amp;gt; Applications&lt;br&gt;
Kernel modules  &amp;mdash;&amp;gt; Block Device&lt;br&gt;
Kernelmodules &amp;mdash;&amp;gt; Filesystems&lt;br&gt;
(Utilities  &amp;mdash;&amp;gt;Filesystem)&lt;br&gt;
Kernel modules &amp;mdash;&amp;gt; Native Language Support&lt;br&gt;
Kernel modules &amp;mdash;&amp;gt;  Other modules&lt;br&gt;
Base system  &amp;mdash;&amp;gt;&lt;br&gt;
Kernel modules  &amp;mdash;&amp;gt; USB Support&lt;br&gt;
Network  &amp;mdash;&amp;gt;&lt;br&gt;
Kernel modules  &amp;mdash;&amp;gt; Video Support&lt;br&gt;
Multimedia    &amp;mdash;&amp;gt;&lt;br&gt;
Libraries &amp;mdash;&amp;gt;&lt;br&gt;
Utilities  &amp;mdash;&amp;gt;&lt;br&gt;
Kernel modules &amp;mdash;&amp;gt;Wireless Drivers&lt;br&gt;
Utilities  &amp;mdash;&amp;gt; Compression&lt;br&gt;
Utilities  &amp;mdash;&amp;gt;  Filesystem&lt;br&gt;
Utilities  &amp;mdash;&amp;gt;  disc&lt;br&gt;
Utilities  &amp;ndash;&amp;gt;&lt;br&gt;
Network&amp;ndash;&amp;gt; wireless&lt;br&gt;
Network&amp;ndash;&amp;gt; VPN&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;OpenWRT 软件包中文对照说明:&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;http://www.wbini.com/id-12.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://www.wbini.com/id-12.html&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://onlyke.com/html/713.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;拒绝DNS污染和UDP干扰，在Openwrt路由器上部署DNSCrypt，加密查询DNS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;电视盒子&#34;&gt;电视盒子&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.znds.com/tv-1207323-1-1.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;打造最强华为海思hi3798mv100/200/300机顶盒NAS服务器系统&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://bbs.histb.com/d/83-hi3798&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;hi3798可适配机型维护参考 - From 海思机顶盒NAS社区&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;视频播放相关&#34;&gt;视频播放相关&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://plyr.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;plyr&lt;/a&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://github.com/sampotts/plyr&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;plyr Github&lt;/a&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;http://www.yixao.net/share/16426.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;plyr 一款简单易用，可定制化的Html5的音视频播放器&lt;/a&gt;&lt;br&gt;
特性:&lt;br&gt;
HTML视频和音频&lt;br&gt;
无障碍-完全支持VTT字幕和屏幕阅读器&lt;br&gt;
可自定义-使用所需的标记让播放器可定制化&lt;br&gt;
干净的HTML-使用原生的元素。&lt;br&gt;
表示音量，&lt;br&gt;
自适应-适用于任何屏幕尺寸&lt;br&gt;
流媒体-支持hls.js，Shaka和dash.js流媒体播放&lt;br&gt;
API-通过标准化的API切换播放，音量，搜索等&lt;br&gt;
灵活，所有活动都跨格式标准化&lt;br&gt;
全屏-支持本机全屏并回退到“全屏”模式&lt;br&gt;
⌨️ 快捷键-支持键盘快捷键&lt;br&gt;
画中画-支持画中画模式&lt;br&gt;
Playsinline-支持playsinline属性&lt;br&gt;
速度控制-即时调整速度&lt;br&gt;
多个字幕-支持多个字幕轨道&lt;br&gt;
i18n支持-支持控件国际化&lt;br&gt;
预览缩略图-支持显示预览缩略图&lt;br&gt;
没有框架-用“原生” ES6 JavaScript编写，不需要jQuery&lt;br&gt;
♀️ SASS-包含在您的构建过程中&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Windows 10 - 播放到设备(play to Devices)&lt;br&gt;
执行程序名: wmpdmc.exe&lt;br&gt;
WMPDMC.exe是一个可执行文件，它是Microsoft Corporation开发的Windows Media Player 11程序的一部分。该软件的大小通常约为8.24 MB&lt;br&gt;
这个&amp;quot;播放到设备&amp;quot;功能，是本地视频DLNA投屏功能, 通过此功能可以把视频播放到电视机上，在电视机的大屏幕上播放。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;网络&#34;&gt;网络&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;SSLH：让 HTTPS、SSH 共享端口&lt;br&gt;
考虑的缘由:&lt;br&gt;
· 公网上服务器使用ssh通用端口22/tcp总会招来很多测试攻击;&lt;br&gt;
· 而如果使用非22/tcp端口, 则(应该是)会被当做非正常访问, 而被GFW攻击而出现异常中断
处理的方式:&lt;br&gt;
· 使用VNC方式访问, 缺点是操作相对复杂。&lt;br&gt;
· 让ssh共用已开放的http(或https)端口, 设置上可能麻烦点, 但使用方便。&lt;br&gt;
解决方案参考:&lt;br&gt;
· &lt;a class=&#34;link&#34; href=&#34;https://linux.cn/article-11247-1.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SSLH：让 HTTPS 和 SSH 共享同一个端口&lt;/a&gt;&lt;br&gt;
可以在虚拟机上测试, 并可以同时测试&lt;a class=&#34;link&#34; href=&#34;https://github.com/vaxilu/x-ui&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;x-ui 支持多协议多用户的 xray 面板&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;系统性能测试对比&#34;&gt;系统性能测试(对比)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://openbenchmarking.org/test/pts/sysbench&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;sysbench and (CPUs)result - OpenBenchMarking&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;hugo相关&#34;&gt;HuGo相关&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;(&lt;a class=&#34;link&#34; href=&#34;https://forum.freecodecamp.org/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;freecodecamp&lt;/a&gt;)从WordPress到Hugo — 我如何迁移250多个页面的网站和我使用的脚本:  &lt;a class=&#34;link&#34; href=&#34;https://www.freecodecamp.org/news/wordpress-to-hugo-scripts/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;From WordPress to Hugo – How I Migrated a 250+ Page Site and the Scripts I Used&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;临时链接s&#34;&gt;临时链接(s)&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/445661017&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;知乎: Pycharm安装配置Pyside6&lt;/a&gt;&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.perfcode.com/p/pyside6&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PySide6详细中文教程&lt;/a&gt;&lt;/strong&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;http://www.codebaoku.com/it-python/it-python-227355.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;两种将python打包成exe的方式讲解 - 含auto-py-to-exe&lt;/a&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://cloud.tencent.com/developer/article/1724427&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PyCharm中配置PySide2的图文教程&lt;/a&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://plugins.jetbrains.com/plugin/15282-acode-time&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ACode Time&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;python--pyside&#34;&gt;Python &amp;amp; Pyside&lt;/h2&gt;
&lt;p&gt;**&lt;a class=&#34;link&#34; href=&#34;https://www.daimajiaoliu.com/daima/479a101359003f8&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PySide程序的国际化&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>在Openwrt上建立Docker环境</title>
        <link>https://jimway71.github.io/p/%E5%9C%A8openwrt%E4%B8%8A%E5%BB%BA%E7%AB%8Bdocker%E7%8E%AF%E5%A2%83/</link>
        <pubDate>Tue, 06 Apr 2021 18:06:16 +0800</pubDate>
        
        <guid>https://jimway71.github.io/p/%E5%9C%A8openwrt%E4%B8%8A%E5%BB%BA%E7%AB%8Bdocker%E7%8E%AF%E5%A2%83/</guid>
        <description>&lt;img src="https://jimway71.github.io/wallpaper/wallpaper-30.jpg" alt="Featured image of post 在Openwrt上建立Docker环境" /&gt;&lt;h2 id=&#34;说明&#34;&gt;说明&lt;/h2&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;恩山论坛&lt;/a&gt;的&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-285101.html&#34;  title=&#34;flippy-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;flippy大侠&lt;/a&gt;推出的&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/thread-4076037-1-1.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;55+、55+O S905x3、S922x、贝壳云、我家云、微加云等OP固件&amp;rdquo;&lt;/a&gt;内置了Docker CE容器(服务-Docker CE容器), 但Docker并不(缺省)可用.&lt;br&gt;
在Docker CE容器主页面下, 提供了内置的&amp;quot;Docker 初始化无脑配置教程&amp;quot;链接(一个PDF文件), 按照教程说明, 可以简单的把Docker环境搭建完成.&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/30-q7-01.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Docker 初始化无脑配置教程&#34;
	
	
&gt;&lt;/p&gt;
&lt;h2 id=&#34;环境说明&#34;&gt;环境说明&lt;/h2&gt;
&lt;p&gt;在TF卡里装了&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-285101.html&#34;  title=&#34;flippy-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;flippy大侠&lt;/a&gt;的&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/thread-4076037-1-1.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;OP固件&lt;/a&gt;, 用这张TF卡插在联通(数码视讯)Q7盒子(以下简称Q7)里启动, op可以正常运行.&lt;br&gt;
TF卡中只用不到1G空间被op系统占用, 剩下的分成了一个exfat的主分区.&lt;/p&gt;
&lt;h2 id=&#34;操作步骤&#34;&gt;操作步骤&lt;/h2&gt;
&lt;p&gt;操作步骤大致按照&amp;quot;Docker 初始化无脑配置教程&amp;quot;, 但略有些不同.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;给Docker分配存储空间&lt;br&gt;
由于原来剩余空间都给了exfat主分区, 所以只能重新分配空间.&lt;br&gt;
本想通过调整分区大小来分出部分空间给Docker, 但试了Win10的&amp;quot;硬盘管理&amp;quot;+&amp;ldquo;分区助专业版&amp;rdquo;, 发现都不能把exfat分区的空间调小, 所以只能重新分配空间.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;先备份exfat分区文件&lt;/li&gt;
&lt;li&gt;TF卡重新分区&lt;br&gt;
把TF卡插回Q7的TF卡槽, tf卡启动Q7后, 用SecureCRT登录进去:
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;使用fdisk命令删除原exfat分区&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用fdisk重分两个分区, 一个exfat分区, 一个ext4分区.&lt;br&gt;
考虑到Docker可能不会占用多少空间, 给ext4分了10G的空间.&lt;br&gt;
(exfat分区的类型代码是7)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;格式化(mkfs命令)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# 格式化exfat分区&lt;br&gt;
# mkfs.exfat /dev/sda3&lt;br&gt;
# 格式化ext4分区&lt;br&gt;
# mkfs.ext4 /dev/sda4&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;注意: 如果分区已经mount上就不能格式化, 会显示格式化失败信息.&lt;br&gt;
这种情况需要umount, 如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# umount /dev/sda3&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/30-q7-02.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;相应的教程内容, 执行的shell功能就是分区&amp;#43;格式化&#34;
	
	
&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;↑ 相应的教程内容, 执行的shell功能就是分区+格式化&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;挂载(mount)新分区&lt;br&gt;
把新的ext4分区挂载(mount)到/opt下, 做为Docker的空间.&lt;br&gt;
与mount有关的配置文件有/etc/mtab + /etc/fstab, /etc/fstab是启动时的挂载配置文件.&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/30-q7-03.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;相应的教程内容, 实现新分区挂载到/opt&#34;
	
	
&gt;&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/30-q7-04.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;相应的教程内容, 实现新分区挂载到/opt&#34;
	
	
&gt;&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/30-q7-05.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;相应的教程内容, 实现新分区挂载到/opt&#34;
	
	
&gt;&lt;br&gt;
↑ 相应的教程内容, 实现新分区挂载到/opt&lt;br&gt;
按教程操作完成挂载后, 查看/etc/fstab文件, 并没有看到/opt的挂载信息, 不清楚具体是在哪里配置的.&lt;br&gt;
用mount命令查看, 可以看到已经挂载到/opt下了&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/30-q7-06.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;分区挂载状态&#34;
	
	
&gt;&lt;/li&gt;
&lt;li&gt;把备份的exfat分区文件恢复回去.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;确认Docker的配置文件&lt;br&gt;
修改/etc/docker/daemon.json, 把data-root改为/opt/docker/&lt;br&gt;
说明见文后的问题①&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;安装Docker管理系统&lt;br&gt;
/etc/docker-web是一个shell, 内容如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# cat /etc/docker-web&lt;br&gt;
#!/bin/sh&lt;br&gt;
docker run -d &amp;ndash;restart=always &amp;ndash;name=&amp;ldquo;portainer&amp;rdquo; -p 9999:9000 -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;docker-web是用来安装docker的web管理系统, 执行前需要先确认下docker是否已启动, 如果没有启动, docker-web的安装会失败, 如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# ./docker-web&lt;br&gt;
docker: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?.&lt;br&gt;
See &amp;lsquo;docker run &amp;ndash;help&amp;rsquo;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;使用service命令确认docker运行状态&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# service dockerd status&lt;br&gt;
inactive&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如果发现docker未启动, 则先启动docker&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# service dockerd start&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;再次确认docker运行状态&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# service dockerd status&lt;br&gt;
running&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;确认docker运行后, 可以执行docker-web进行安装&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# ./docker-web&lt;br&gt;
Unable to find image &amp;lsquo;portainer/portainer-ce:latest&amp;rsquo; locally&lt;br&gt;
latest: Pulling from portainer/portainer-ce&lt;br&gt;
84cfa456b2b1: Pull complete&lt;br&gt;
39d56ef0881a: Pull complete&lt;br&gt;
16a45878c700: Pull complete&lt;br&gt;
Digest:&lt;br&gt;
Status: Downloaded newer image for portainer/portainer-ce:latest&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;进入Docker管理界面&lt;br&gt;
在浏览器里输入Q7的ip地址:9999, 设置管理员密码, 选择local进入本地管理界面&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/30-q7-07.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Docker管理界面&#34;
	
	
&gt;&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/30-q7-08.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Docker管理界面&#34;
	
	
&gt;&lt;br&gt;
点鲸鱼图标即可管理本地的docker&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;问题&#34;&gt;问题&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;① Docker的配置文件有问题, 需要修改&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# cat /etc/docker/daemon.json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;bip&amp;#34;: &amp;#34;172.31.0.1/24&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;data-root&amp;#34;: &amp;#34;/mnt/mmcblk2p4/docker/&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;log-level&amp;#34;: &amp;#34;warn&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;log-driver&amp;#34;: &amp;#34;json-file&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;log-opts&amp;#34;: {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &amp;#34;max-size&amp;#34;: &amp;#34;10m&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &amp;#34;max-file&amp;#34;: &amp;#34;5&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   },
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &amp;#34;registry-mirrors&amp;#34;: [
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &amp;#34;https://dockerhub.azk8s.cn&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   ]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其中data-root所指/mnt/mmcblk2p4不存在, 由于给docker分配的空间是/opt, 因此考虑把data-root所指目录改到/opt/docker/下&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Q&amp;A</title>
        <link>https://jimway71.github.io/p/qa/</link>
        <pubDate>Sat, 03 Apr 2021 22:57:16 +0800</pubDate>
        
        <guid>https://jimway71.github.io/p/qa/</guid>
        <description>&lt;img src="https://jimway71.github.io/wallpaper/wallpaper-29.jpg" alt="Featured image of post Q&amp;A" /&gt;&lt;h2 id=&#34;问题-旧版securecrt不能连接新版本的sshd服务器&#34;&gt;问题: 旧版SecureCrt不能连接新版本的sshd服务器&lt;/h2&gt;
&lt;p&gt;报错如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Key exchange failed. No compatible key exchange method. The server supports these methods: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;原因分析:&lt;br&gt;
旧版SecureCrt(版本号6.7.0 (build 153))支持的密钥交换(Key exchange)为以下5种:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kerberos&lt;/li&gt;
&lt;li&gt;Kerberos(Group Exchange)&lt;/li&gt;
&lt;li&gt;Diffie-hellman-group14&lt;/li&gt;
&lt;li&gt;Diffie-hellman-group&lt;/li&gt;
&lt;li&gt;Diffie-hellman&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这5种均不被新的sshd支持, 当前sshd版本信息为:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;OpenSSH_8.3p1, OpenSSL 1.1.1j  16 Feb 2021&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;处理方式:&lt;br&gt;
修改/etc/ssh/sshd_config文件, 添加(我是在文件最后添加):&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;KexAlgorithms diffie-hellman-group14-sha1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后重启sshd:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;#service sshd restart&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;即可。&lt;br&gt;
(看参考的文档, 说的是添加:&lt;br&gt;
KexAlgorithms &lt;a class=&#34;link&#34; href=&#34;mailto:curve25519-sha256@libssh.org&#34; &gt;curve25519-sha256@libssh.org&lt;/a&gt;,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1&lt;br&gt;
其实添加一种SecureCrt支持的方式就可以了)&lt;br&gt;
参考:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/duanbiren123/article/details/103034914&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;升级ssh后续问题&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;http://www.tomato.cm/179.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;使用SecureCRT连接Ubuntu20.04报错：Key exchange failed. No compatible key exchange method&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/shenjianyu/p/6407042.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;升级openssh带来的问题&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;更新:&lt;/strong&gt;&lt;br&gt;
可以改用基于&lt;a class=&#34;link&#34; href=&#34;file:///C:/Users/jimway/AppData/Local/Temp/Mxt220/tmp/licenses/EulaHOME.html&#34; &gt;MobaXterm license&lt;/a&gt;许可的&lt;a class=&#34;link&#34; href=&#34;https://mobaxterm.mobatek.net/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;MobaXterm&lt;/a&gt;, 不再有这种问题。&lt;/p&gt;
&lt;h2 id=&#34;问题-在openwrt上新建一个可用的samba用户&#34;&gt;问题: 在openwrt上新建一个可用的samba用户&lt;/h2&gt;
&lt;p&gt;需要解决的问题:&lt;br&gt;
需要新增一个samba用户, 而samba用户是与同名系统用户关联的, 所以需要先建立一个同名的系统用户.&lt;br&gt;
但是, 当前Openwrt的底层系统里没有useradd或者adduser命令, 用opkg update更新后, 搜索可用的包里也没找到相关的包, 包括有人提到的shadow-useradd或者类似的命令, 所以, 不能用命令添加一个用户&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;那, 就先手动来新增一个用户&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;修改/etc/passwd文件, 增加新用户信息&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# vim /etc/passwd&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;增加一行:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;newuser:x:66666:66666:newuser:/home/newuser:/bin/ash&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;说明:&lt;br&gt;
newuser是用户名, /home/newuser就是newuser用户的根目录了.&lt;br&gt;
66666是用户ID, 要注意在整个passwd文件是应该是唯一的.&lt;br&gt;
/bin/ash是shell, 是从root用户那行抄来的&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;修改/etc/group文件, 增加新用户的组信息: 组名和用户名一般都是相同的&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# vim /etc/group&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;增加一行:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;newuser:x:66666:newuser&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;说明:&lt;br&gt;
组名和用户名相同&lt;br&gt;
组ID号和用户ID号也相同&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;建立新用户根目录, 并设置属主/组&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# mkdir /home/newuser&lt;br&gt;
# chown newuser /home/newuser&lt;br&gt;
# chgrp newuser /home/newuser&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;给新用户设置密码&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# passwd newuser&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;该设置samba用户了&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;给samba新用户设置密码&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;del&gt;# smbpasswd newuser&lt;/del&gt;&lt;br&gt;
&lt;del&gt;&amp;hellip;&amp;hellip;&lt;/del&gt;&lt;br&gt;
&lt;del&gt;Failed to find entry for user newuser.&lt;/del&gt;&lt;br&gt;
# smbpasswd -a newuser&lt;br&gt;
&amp;hellip;&amp;hellip;&lt;br&gt;
Added user newuser.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使samba新用户可用&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# smbpasswd -e newuser&lt;br&gt;
Enabled user newuser.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;问题-在openwrt上设置samba服务器-windowswin10es文件浏览器都可以通过网络访问&#34;&gt;问题: 在openwrt上设置samba服务器, Windows/Win10/Es文件浏览器都可以通过网络访问.&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;环境说明:&lt;/strong&gt;&lt;br&gt;
用S905L的盒子装了个openwrt, 装在TF卡上, 用TF卡启动.&lt;br&gt;
TF卡上除了装op系统的大概1G空间外, 剩下的空间分区并格式化为exfat格式, op启动时会自动加载这个exfat分区, 使用samba(web上在网络存储-网络共享)共享出来可供局域网内设备访问.&lt;br&gt;
Win10当前版本缺省不支持SMB 1.0/CIFS, 为了访问低版本的samba设备, 已通过&amp;quot;启用或关闭Windows功能&amp;quot;打开&amp;quot;SMB 1.0/CIFS文件共享支持&amp;quot;+&amp;ldquo;SMB Direct&amp;rdquo;, 需要能让这种设备访问盒子上的samba服务器 - 其实这并不是一个问题, 当前版本的samba(V4.11.6)早已支持新版本的samba协议.&lt;br&gt;
安卓手机app&amp;quot;Es文件管理器&amp;quot;也需要在局域网内能访问同一个samba服务器.&lt;br&gt;
&lt;strong&gt;问题详述:&lt;/strong&gt;&lt;br&gt;
&lt;u&gt;问题1. linux上的samba服务器与Windows的Samba服务器是有区别的&lt;/u&gt;&lt;br&gt;
Windows的samba服务器被访问时, 如果需要用户登录, 会在开始连接时就要求登录.&lt;br&gt;
而Linux的samba服务器被访问时, 只有当访问到&amp;quot;共享目录&amp;quot;时, 才会问到登录信息.&lt;br&gt;
&lt;u&gt;问题2. 当前版本的Win10在访问samba服务时, 已经不支匿名访问, 只能修改注册表信息来支持&lt;/u&gt;&lt;br&gt;
这个操作比较麻烦, 不考虑&lt;br&gt;
测试中发现, 当一个samba服务器里只要存在任何一个可以匿名访问的文件共享, Win10就无法访问整个Samba服务器, 因此要求samba服务器中的任何共享都是非匿名访问的.&lt;br&gt;
&lt;u&gt;问题3 Es文件管理器App访问linux上的Samba服务器时, 缺省是以匿名方式访问&lt;/u&gt;&lt;br&gt;
不会主动弹出登录信息窗口, 即使无法打开一个需要登录的共享时, 也不会主动弹出.&lt;br&gt;
这就需要手动设置Es的登录信息.&lt;br&gt;
这个问题和问题1有相关性.&lt;br&gt;
&lt;strong&gt;其他&lt;/strong&gt;&lt;br&gt;
由于exfat是微软的文件格式, 没有用户权限信息, 避开了linux复杂的权限问题, 因此选择使用这种文件格式&lt;br&gt;
&lt;strong&gt;结论:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;op上的samba共享都需要设置成用户登录访问&lt;/li&gt;
&lt;li&gt;Es访问时需要手动设置用户登录信息.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Samba服务器的设置如下&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;配置文件&lt;br&gt;
op上luci的缺省配置文件如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[global]&lt;br&gt;
netbios name = |NAME|&lt;br&gt;
interfaces = |INTERFACES|&lt;br&gt;
server string = |DESCRIPTION|&lt;br&gt;
unix charset = |CHARSET|&lt;br&gt;
workgroup = |WORKGROUP|&lt;/p&gt;
&lt;p&gt;## This global parameter allows the Samba admin to limit what interfaces on a machine will serve SMB requests.&lt;br&gt;
bind interfaces only = yes&lt;/p&gt;
&lt;p&gt;## time for inactive connections to-be closed in minutes&lt;br&gt;
deadtime = 15&lt;/p&gt;
&lt;p&gt;## disable core dumps&lt;br&gt;
enable core files = no&lt;/p&gt;
&lt;p&gt;## set security (auto, user, domain, ads)&lt;br&gt;
security = user&lt;/p&gt;
&lt;p&gt;## This parameter controls whether a remote client is allowed or required to use SMB encryption.&lt;br&gt;
## It has different effects depending on whether the connection uses SMB1 or SMB2 and newer:&lt;br&gt;
## If the connection uses SMB1, then this option controls the use of a Samba-specific extension to the SMB protocol introduced in Samba 3.2 that makes   use of the Unix extensions.
server min protocol = NT1&lt;br&gt;
client min protocol = NT1&lt;br&gt;
## If the connection uses SMB2 or newer, then this option controls the use of the SMB-level encryption that is supported in SMB version 3.0 and above and available in Windows 8 and newer.&lt;br&gt;
## (default/auto,desired,required,off)&lt;br&gt;
#smb encrypt = default&lt;/p&gt;
&lt;p&gt;## set invalid users&lt;br&gt;
invalid users = root&lt;/p&gt;
&lt;p&gt;## map unknow users to guest&lt;br&gt;
map to guest = Bad User&lt;/p&gt;
&lt;p&gt;## allow client access to accounts that have null passwords.&lt;br&gt;
null passwords = yes&lt;/p&gt;
&lt;p&gt;## The old plaintext passdb backend. Some Samba features will not work if this passdb backend is used. (NOTE: enabled for size reasons)&lt;br&gt;
## (tdbsam,smbpasswd,ldapsam)&lt;br&gt;
passdb backend = smbpasswd&lt;/p&gt;
&lt;p&gt;## Set location of smbpasswd (&amp;lsquo;smbd -b&amp;rsquo; will show default compiled location)&lt;br&gt;
#smb passwd file = /etc/samba/smbpasswd&lt;/p&gt;
&lt;p&gt;## LAN/WAN options (IPTOS_LOWDELAY TCP_NODELAY) WAN (IPTOS_THROUGHPUT)&lt;br&gt;
socket options = IPTOS_LOWDELAY TCP_NODELAY&lt;/p&gt;
&lt;p&gt;## If this integer parameter is set to a non-zero value, Samba will read from files asynchronously when the request size is bigger than this value.&lt;br&gt;
## Note that it happens only for non-chained and non-chaining reads and when not using write cache.&lt;br&gt;
## The only reasonable values for this parameter are 0 (no async I/O) and 1 (always do async I/O).&lt;br&gt;
## (1/0)&lt;br&gt;
#aio read size = 0&lt;br&gt;
#aio write size = 0&lt;/p&gt;
&lt;p&gt;## If Samba has been built with asynchronous I/O support, Samba will not wait until write requests are finished before returning the result to the client for files listed in this parameter.&lt;br&gt;
## Instead, Samba will immediately return that the write request has been finished successfully, no matter if the operation will succeed or not.&lt;br&gt;
## This might speed up clients without aio support, but is really dangerous, because data could be lost and files could be damaged.&lt;br&gt;
#aio write behind = /*.tmp/&lt;/p&gt;
&lt;p&gt;## lower CPU useage if supported and aio is disabled (aio read size = 0 ; aio write size = 0)&lt;br&gt;
## currently broken (NOTE: see &lt;a class=&#34;link&#34; href=&#34;https://bugzilla.samba.org/show_bug.cgi?id=14095&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://bugzilla.samba.org/show_bug.cgi?id=14095&lt;/a&gt; )&lt;br&gt;
## (no, yes)&lt;br&gt;
#use sendfile = yes&lt;/p&gt;
&lt;p&gt;## samba will behave as previous versions of Samba would and will fail the lock request immediately if the lock range cannot be obtained.&lt;br&gt;
#blocking locks = No&lt;/p&gt;
&lt;p&gt;## disable loading of all printcap printers by default (iprint, cups, lpstat)&lt;br&gt;
load printers = No&lt;br&gt;
printcap name = /dev/null&lt;/p&gt;
&lt;p&gt;## Enabling this parameter will disable Samba&amp;rsquo;s support for the SPOOLSS set of MS-RPC&amp;rsquo;s.&lt;br&gt;
disable spoolss = yes&lt;/p&gt;
&lt;p&gt;## This parameters controls how printer status information is interpreted on your system.&lt;br&gt;
## (BSD, AIX, LPRNG, PLP, SYSV, HPUX, QNX, SOFTQ)&lt;br&gt;
printing = bsd&lt;/p&gt;
&lt;p&gt;## Disable that nmbd is acting as a WINS server for unknow netbios names&lt;br&gt;
#dns proxy = No&lt;/p&gt;
&lt;p&gt;## win/unix user mapping backend&lt;br&gt;
#idmap config * : backend = tdb&lt;/p&gt;
&lt;p&gt;## Allows the server name that is advertised through MDNS to be set to the hostname rather than the Samba NETBIOS name.&lt;br&gt;
## This allows an administrator to make Samba registered MDNS records match the case of the hostname rather than being in all capitals.&lt;br&gt;
## (netbios, mdns)&lt;br&gt;
mdns name = mdns&lt;/p&gt;
&lt;p&gt;## Clients that only support netbios won&amp;rsquo;t be able to see your samba server when netbios support is disabled.&lt;br&gt;
#disable netbios = Yes&lt;/p&gt;
&lt;p&gt;## Setting this value to no will cause nmbd never to become a local master browser.&lt;br&gt;
#local master = no&lt;/p&gt;
&lt;p&gt;## (auto, yes) If this is set to yes, on startup, nmbd will force an election, and it will have a slight advantage in winning the election. It is recommended that this parameter is used in conjunction with domain master = yes, so that nmbd can guarantee becoming a domain master.&lt;br&gt;
#preferred master = yes&lt;/p&gt;
&lt;p&gt;## (445 139) Specifies which ports the server should listen on for SMB traffic.&lt;br&gt;
## 139 is netbios/nmbd&lt;br&gt;
#smb ports = 445 139&lt;/p&gt;
&lt;p&gt;## This is a list of files and directories that are neither visible nor accessible.&lt;br&gt;
## Each entry in the list must be separated by a &amp;lsquo;/&amp;rsquo;, which allows spaces to be included in the entry. &amp;lsquo;*&amp;rsquo; and &amp;lsquo;?&amp;rsquo; can be used to specify multiple files or directories as in DOS wildcards.&lt;br&gt;
veto files = /Thumbs.db/.DS_Store/._.DS_Store/.apdisk/&lt;/p&gt;
&lt;p&gt;## If a directory that is to be deleted contains nothing but veto files this deletion will fail unless you also set the delete veto files parameter to   yes.&lt;br&gt;
delete veto files = yes&lt;/p&gt;
&lt;p&gt;################ Filesystem and creation rules ################&lt;br&gt;
## reported filesystem type (NTFS,Samba,FAT)&lt;br&gt;
#fstype = FAT&lt;/p&gt;
&lt;p&gt;## Allows a user who has write access to the file (by whatever means, including an ACL permission) to modify the permissions (including ACL) on it.&lt;br&gt;
#dos filemode = Yes&lt;/p&gt;
&lt;p&gt;## file/dir creating rules&lt;br&gt;
#create mask = 0666&lt;br&gt;
#directory mask = 0777&lt;br&gt;
#force group = root&lt;br&gt;
#force user = root&lt;br&gt;
#inherit owner = windows and unix&lt;br&gt;
################################################################&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这个配置文件只需要屏蔽 invalid users = root 这一句, 如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;#invalid users = root&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;设置samba用户&lt;br&gt;
使用&amp;quot;&lt;a class=&#34;link&#34; href=&#34;https://jimway71.github.io/p/qa/#%E9%97%AE%E9%A2%98-%E5%9C%A8openwrt%E4%B8%8A%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%8F%AF%E7%94%A8%E7%9A%84samba%E7%94%A8%E6%88%B7&#34; &gt;在openwrt上新建一个可用的samba用户&lt;/a&gt;&amp;ldquo;的方法建立用户&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;设置共享目录(补记: 可能是在Luci的界面里)&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/29-qa-01.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;设置共享目录&#34;
	
	
&gt;&lt;br&gt;
按上图方式设置共享目录, 允许用户是刚才设置的smb用户.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;访问&lt;br&gt;
Win10正常访问.&lt;br&gt;
Es文件浏览器App在局域网里设置相应服务器的登录信息后就可以正常访问.&lt;br&gt;
读写都没有问题.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;emuelec2020春节整合版s905-被百毒封了&#34;&gt;EmuELEC2020春节整合版(s905) 被百毒封了&lt;/h2&gt;
&lt;p&gt;EmuELEC 3.3.1 2020春节整合版详细说明: &lt;a class=&#34;link&#34; href=&#34;https://www.bilibili.com/read/cv4420521/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.bilibili.com/read/cv4420521/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;u&gt;下载地址：&lt;/u&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://cloud.189.cn/t/F7JfYbF7VnU&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;EmuELEC2020春节整合版(s905) 被百毒封了&lt;/a&gt;  (访问码:nlp7) -&amp;gt; 已经转&lt;a class=&#34;link&#34; href=&#34;https://cloud.189.cn/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;天翼云&lt;/a&gt; 需要的请下载&lt;a class=&#34;link&#34; href=&#34;https://space.bilibili.com/97745521&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;@人中日月&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;基础包链接：&lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/1s03OQf60qQCmH8dejykplw&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://pan.baidu.com/s/1s03OQf60qQCmH8dejykplw&lt;/a&gt; 提取码：g13u&lt;br&gt;
(三个增补包，分别是街机改版、ATOMISWAVE和NAOMI的整合包，需要自己另外根据EMUELEC使用指南里面的方法传到系统里。)&lt;/li&gt;
&lt;li&gt;增量包链接：&lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/17xkfIu-Wg1CzKAq9sGrXIw&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://pan.baidu.com/s/17xkfIu-Wg1CzKAq9sGrXIw&lt;/a&gt; 提取码：zkdr&lt;/li&gt;
&lt;li&gt;斐讯N1补丁包链接：&lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/1RaNq2VaWiPvxX-4q2cjs1A&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://pan.baidu.com/s/1RaNq2VaWiPvxX-4q2cjs1A&lt;/a&gt; 提取码：pty4&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;另外, 还有&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Vol4增量包, 应该是FBN街机的&lt;/li&gt;
&lt;li&gt;3.4版的更新包,更新emuelec到3.4&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;问题-openwrt的history只能看到当前连接的命令记录&#34;&gt;问题: openwrt的history只能看到当前连接的命令记录&lt;/h2&gt;
&lt;p&gt;原因: op缺省使用的是ash, 这个轻量化的shell就是这样，除非改用别的shell, 比如bash&lt;br&gt;
处理:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;安装bash&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# opkg update &amp;amp; opkg install bash&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;设置用户使用bash&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# vim /etc/passwd&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;修改相应用户的shell为bash，并保存退出。&lt;br&gt;
登出并重新登录后新的shell生效&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# echo $SHELL&lt;br&gt;
/bin/bash&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看history&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# history&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;应该能看到记录，登出再进，可以看到文件～/.bash_history(bash的history 记录文件)&lt;/p&gt;
&lt;h2 id=&#34;网络相关问题-内网互联&#34;&gt;网络相关问题: 内网互联&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://segmentfault.com/a/1190000016556569&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;frp 和 nginx 搭建一个内网穿透服务器&lt;/a&gt;&lt;br&gt;
网络结构: 外网nginx -&amp;gt; 外网frp server &amp;lt;-&amp;gt; 内网frp client -&amp;gt; 内网web&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.anquanke.com/post/id/231424&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;内网渗透代理之frp的应用与改造（一）&lt;/a&gt;&lt;br&gt;
相关的&lt;a class=&#34;link&#34; href=&#34;https://github.com/mstxq17/FrpProPlugin&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;FrpProPlugin&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://hostloc.com/forum.php?mod=viewthread&amp;amp;tid=820833&amp;amp;extra=&amp;amp;page=2&amp;amp;mobile=2&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;(rinetd YYDS)socat居然比iptab效率高&lt;/a&gt;&lt;br&gt;
我映象比较深的就是 iptables frp nginx socat haproxy rinetd&lt;br&gt;
因为我是转发到rdp然后看油管，稍微卡顿都可以很明显的感觉出来。rinetd很流畅，haproxy和frp可以勉强用用，其它的都是战五渣。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.v2ex.com/t/567570&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;自认为比 frp 更好用的内网穿透工具 nps&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这里列举了一些比较好用的开源的内网穿透工具，详细介绍一下各个软件工具的特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;frp&lt;br&gt;
FRP 功能完整，主要采用 GO 语言实现，重量级的工具，服务端界面样式风格一般。&lt;br&gt;
配置繁琐，不同的协议需要配置不同的参数，采用文件存放数据，不支持数据库管理数据。&lt;/li&gt;
&lt;li&gt;holer&lt;br&gt;
轻量级的内网穿透工具，holer 服务端采用 Java 语言实现，服务端界面漂亮简洁。&lt;br&gt;
Holer 客户端采用了 Java 语言和 GO 语言实现了两种版本，支持几乎所有的 OS 平台。&lt;br&gt;
用到流行的微服务框架 springboot 和 Java 网络框架 netty。&lt;br&gt;
配置很简单，针对所有 TCP 协议只需在客户端设置一个 holer access key 即可。&lt;br&gt;
采用 MySQL 数据库统一管理数据。&lt;/li&gt;
&lt;li&gt;nps&lt;br&gt;
轻量级的内网穿透工具，完全采用 GO 语言实现，服务端界面漂亮简洁。&lt;br&gt;
支持的协议最广泛，配置稍简单，采用文件存放数据，不支持数据库管理数据。&lt;/li&gt;
&lt;li&gt;lanproxy&lt;br&gt;
轻量级的内网穿透工具，客户端采用 GO 语言和 Java 语言实现两种版本，采用了 Java 网络框架 netty，服务端界面体验较差。&lt;br&gt;
配置稍繁琐，采用文件存放数据，不支持数据库管理数据。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其他:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.nasge.com/archives/48.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;内网穿透工具比较(ngrok,frp,lanproxy,goproxy,nps)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://doubibackup.com/wkcjzpyd-2.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;关于目前 GFW(墙) 的封锁方式TCP封锁(阻断)猜想&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;问题-ubuntu采用docker官方shell安装时报错&#34;&gt;问题: ubuntu采用Docker官方shell安装时报错&lt;/h2&gt;
&lt;p&gt;报错信息如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# curl -fsSL &lt;a class=&#34;link&#34; href=&#34;https://get.docker.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://get.docker.com&lt;/a&gt; -o get-docker.sh&lt;br&gt;
# sh get-docker.sh&lt;br&gt;
# Executing docker install script, commit: 7cae5f8b0decc17d6571f9f52eb840fbc13b2737&lt;br&gt;
+ sh -c apt-get update -qq &amp;gt;/dev/null&lt;br&gt;
W: The repository &amp;lsquo;cdrom://Ubuntu-Server 16.04.6 LTS &lt;em&gt;Xenial Xerus&lt;/em&gt; - Release amd64 (20190226) xenial Release&amp;rsquo; does not have a Release file.&lt;br&gt;
E: Failed to fetch cdrom://Ubuntu-Server 16.04.6 LTS &lt;em&gt;Xenial Xerus&lt;/em&gt; - Release amd64 (20190226)/dists/xenial/main/binary-amd64/Packages  Please use apt-cdrom to make this CD-ROM recognized by APT. apt-get update cannot be used to add new CD-ROMs&lt;br&gt;
E: Some index files failed to download. They have been ignored, or old ones used instead.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;错误处理, 操作如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# vim /etc/apt/sources.list&lt;br&gt;
# 屏蔽掉有cdrom的那一行, 如下&lt;br&gt;
#deb cdrom:[Ubuntu-Server 16.04.6 LTS &lt;em&gt;Xenial Xerus&lt;/em&gt; - Release amd64 (20190226)]/ xenial main restricted&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;参考: &lt;a class=&#34;link&#34; href=&#34;https://linux.cn/article-5409-1.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;如何修复 apt-get update 无法添加新的 CD-ROM 的错误&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;问题-padavan路由作二级桥接无线路由时-系统时间混乱的问题处理&#34;&gt;问题: Padavan路由作二级桥接无线路由时, 系统时间混乱的问题处理&lt;/h2&gt;
&lt;p&gt;状态: 配置了NTP同步, 但无效&lt;br&gt;
原因: 可能是没有配置WAN造成的&lt;br&gt;
处理:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;手动:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# ntpd -t -p 192.168.1.1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;自动&lt;br&gt;
在&amp;quot;系统管理&amp;rdquo;-&amp;ldquo;服务&amp;quot;中修改&amp;quot;调度任务 (Crontab)&amp;rdquo;, 增加&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;0 * * * * ntpd -t -p 192.168.1.1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;让系统每小时都做一次时间同步.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;linux下-以指定用户身份执行&#34;&gt;Linux下, 以指定用户身份执行&lt;/h2&gt;
&lt;p&gt;例: # su - 用户名 -c &amp;ldquo;命令&amp;rdquo;&lt;br&gt;
如:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# su - user -c &amp;ldquo;whoami&amp;rdquo;&lt;br&gt;
user&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;说明: 以用户user身份执行whoami, 返回的用户身份是&amp;quot;user&amp;quot;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>联通(数码视讯)Q7盒子再刷Openwrt</title>
        <link>https://jimway71.github.io/p/%E8%81%94%E9%80%9A%E6%95%B0%E7%A0%81%E8%A7%86%E8%AE%AFq7%E7%9B%92%E5%AD%90%E5%86%8D%E5%88%B7openwrt/</link>
        <pubDate>Mon, 15 Mar 2021 00:49:16 +0800</pubDate>
        
        <guid>https://jimway71.github.io/p/%E8%81%94%E9%80%9A%E6%95%B0%E7%A0%81%E8%A7%86%E8%AE%AFq7%E7%9B%92%E5%AD%90%E5%86%8D%E5%88%B7openwrt/</guid>
        <description>&lt;img src="https://jimway71.github.io/wallpaper/wallpaper-27.jpg" alt="Featured image of post 联通(数码视讯)Q7盒子再刷Openwrt" /&gt;&lt;h2 id=&#34;说明&#34;&gt;说明&lt;/h2&gt;
&lt;p&gt;联通(数码视讯)Q7盒子(以下简称Q7)做为一个电视盒子应该是没有什么可取之处, 但还可以做点别的, 比如, 做&lt;a class=&#34;link&#34; href=&#34;https://openwrt.org/&#34;  title=&#34;Openwrt-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Openwrt&lt;/a&gt;盒子。&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/&#34;  title=&#34;恩山-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;恩山论坛&lt;/a&gt;的&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-285101.html&#34;  title=&#34;flippy-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;flippy大侠&lt;/a&gt;推出了&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/thread-4076037-1-1.html&#34;  title=&#34;多盒OP固件-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;55+、55+O S905x3、S922x、贝壳云、我家云、微加云等OP固件&amp;rdquo;&lt;/a&gt;, 是基于&lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;amlogic(晶晨)&lt;/a&gt;的S9xx系列arm SOC的&lt;a class=&#34;link&#34; href=&#34;https://openwrt.org/&#34;  title=&#34;Openwrt-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Openwrt&lt;/a&gt;固件, 现在支持包括基于amlogic(晶晨) S922x、S912、&lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/196/index.html&#34;  title=&#34;S905X-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905x&lt;/a&gt;、s905x2、S905x3、S905d等多款SOC的盒子。&lt;br&gt;
但是, &lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-285101.html&#34;  title=&#34;flippy-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;flippy大侠&lt;/a&gt;的固件说明中, 并未明确指出对&lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/414/index.html&#34;  title=&#34;S905L-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905L&lt;/a&gt;的支持, 而Q7用的SOC是&lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/414/index.html&#34;  title=&#34;S905L-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905L&lt;/a&gt;。&lt;br&gt;
查到&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Amlogic&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;维基Amlogic&lt;/a&gt;说明中是这么说的:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;u&gt;Amlogic &lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/414/index.html&#34;  title=&#34;S905L-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905L&lt;/a&gt;: 与&lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/196/index.html&#34;  title=&#34;S905X-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905X&lt;/a&gt;相似，不同之处在于它支持HDMI 2.0b，但缺少VP9解码，摄像头接口和TS输入。&lt;/u&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;按这种说法, &lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/414/index.html&#34;  title=&#34;S905L-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905L&lt;/a&gt;可能是和&lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/196/index.html&#34;  title=&#34;S905X-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905X&lt;/a&gt;差不多, 支持&lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/196/index.html&#34;  title=&#34;S905X-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905X&lt;/a&gt;应该就能支持&lt;a class=&#34;link&#34; href=&#34;https://www.amlogic.com/#Products/414/index.html&#34;  title=&#34;S905L-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;S905L&lt;/a&gt;, 那么Q7就应该能用。&lt;br&gt;
推论如此, 然后在网上找到了一个实例, &lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/&#34;  title=&#34;恩山-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;恩山论坛&lt;/a&gt;的&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-593965.html&#34;  title=&#34;len_-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Len_&lt;/a&gt;大侠在&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/thread-3570786-1-1.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;联通北京数码Q7,S905L电视盒刷成了openwrt系统路由器&amp;rdquo;&lt;/a&gt;贴子里, 明确说明他已经成功完成了将Q7刷上了&lt;a class=&#34;link&#34; href=&#34;https://openwrt.org/&#34;  title=&#34;Openwrt-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Openwrt&lt;/a&gt;, 虽然没有详细说明, 但从帖子里可以看出来大概是怎么做的, 那么, 就跟随&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-593965.html&#34;  title=&#34;len_-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Len_&lt;/a&gt;大侠, 让Q7废物利用吧。&lt;br&gt;
为了简单化(偷懒😁), 选用的是使用&lt;strong&gt;外接存储(U盘或TF卡)启动Q7&lt;/strong&gt;的方式。&lt;br&gt;
&lt;u&gt;Q7自带TF卡槽&lt;/u&gt;, 这倒是为数不多的优点之一。&lt;/p&gt;
&lt;h2 id=&#34;补充&#34;&gt;补充&lt;/h2&gt;
&lt;p&gt;在&lt;a class=&#34;link&#34; href=&#34;https://github.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Github&lt;/a&gt;上找了下&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-285101.html&#34;  title=&#34;flippy-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;flippy大侠&lt;/a&gt;的源码,  感觉应该是这个: &lt;a class=&#34;link&#34; href=&#34;https://github.com/lllrrr/mknop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;lllrrr/mknop&lt;/a&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://github.com/tuanqing/mknop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;tuanqing/mknop&lt;/a&gt;这个肯定是分支。&lt;br&gt;
另外, &lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-285101.html&#34;  title=&#34;flippy-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;flippy大侠&lt;/a&gt;还做了&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/thread-958173-1-1.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Docker Openwrt&lt;/a&gt;, 看看里面引用的内核源代码来源:&lt;br&gt;
&lt;strong&gt;内核源码来源说明(两个平*的内核都来自各自最活跃的上游发布者)&lt;/strong&gt;&lt;br&gt;
Amlogic内核：  &lt;a class=&#34;link&#34; href=&#34;https://github.com/150balbes/Amlogic_s905-kernel&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/150balbes/Amlogic_s905-kernel&lt;/a&gt; （5.3.0）&lt;br&gt;
Rockchip内核:   &lt;a class=&#34;link&#34; href=&#34;https://github.com/ayufan-rock64/linux-mainline-kernel/releases&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/ayufan-rock64/linux-mainline-kernel/releases&lt;/a&gt;  （5.3.0）&lt;br&gt;
公版内核补丁： &lt;a class=&#34;link&#34; href=&#34;https://kernel.org&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://kernel.org&lt;/a&gt;  （当前最新5.3.6补丁）&lt;br&gt;
FullCone-Nat： &lt;a class=&#34;link&#34; href=&#34;https://github.com/Chion82/netfilter-full-cone-nat%20%20%20%20&amp;#43;%20%20952-net-conntrack-events-support-multiple-registrant.patch&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;netfilter-full-cone-nat    +  952-net-conntrack-events-support-multiple-registrant.patch&lt;/a&gt;&lt;br&gt;
(来自&lt;a class=&#34;link&#34; href=&#34;https://openwrt.org/&#34;  title=&#34;Openwrt-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;openwrt&lt;/a&gt;源码)&lt;br&gt;
exfat:              &lt;a class=&#34;link&#34; href=&#34;https://github.com/dorimanx/exfat-nofuse&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/dorimanx/exfat-nofuse&lt;/a&gt;&lt;br&gt;
Wireguard:      &lt;a class=&#34;link&#34; href=&#34;https://git.zx2c4.com/WireGuard&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://git.zx2c4.com/WireGuard&lt;/a&gt;&lt;br&gt;
&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;h2 id=&#34;参考&#34;&gt;参考&lt;/h2&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/thread-4076037-1-1.html&#34;  title=&#34;多盒OP固件-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;55+、55+O S905x3、S922x、贝壳云、我家云、微加云等OP固件&amp;rdquo;&lt;/a&gt; From &lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-285101.html&#34;  title=&#34;flippy-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;flippy大侠&lt;/a&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/thread-3570786-1-1.html&#34;  title=&#34;S905L电视盒刷op-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;联通北京数码Q7,S905L电视盒刷成了openwrt系统路由器&amp;rdquo;&lt;/a&gt; From &lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-593965.html&#34;  title=&#34;len_-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Len_&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;所需工具及软件&#34;&gt;所需工具及软件&lt;/h2&gt;
&lt;p&gt;说明: 可以使用U盘或TF卡启动, SD卡没准也可以。 这里使用的是TF卡。&lt;br&gt;
除了&lt;a class=&#34;link&#34; href=&#34;https://jimway71.github.io/p/%e8%81%94%e9%80%9a%e6%95%b0%e7%a0%81%e8%a7%86%e8%ae%afq7%e7%94%b5%e8%a7%86%e7%9b%92%e5%ad%90%e5%88%b7%e6%9c%ba%e6%88%90%e5%8a%9f-%e4%bd%86%e8%bf%99q7%e7%9b%92%e5%ad%90%e6%98%af%e7%9c%9f%e7%9a%84%e5%9e%83%e5%9c%be/&#34;  title=&#34;Q7盒子垃圾-&amp;gt;&#34;
    &gt;&amp;ldquo;联通(数码视讯)Q7电视盒子刷机成功, 但这Q7盒子是真的垃圾!&amp;rdquo;&lt;/a&gt;帖子中所用的工具及软件外, 还需要用到:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;4G或以上大小的TF卡 + 读卡器&lt;br&gt;
用于制做盒子启动盘(TF卡)。&lt;/li&gt;
&lt;li&gt;镜像写入U盘工具&lt;br&gt;
用于把固件镜像文件写到TF卡里。&lt;br&gt;
Windows上这类工具很多, 选用的是&lt;a class=&#34;link&#34; href=&#34;https://www.alexpage.de/download/usbit/usbit.zip&#34;  title=&#34;USB Image Tool-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;USB Image Tool&lt;/a&gt;, 绿色软件, 不需要安装。&lt;/li&gt;
&lt;li&gt;安卓调试工具&lt;a class=&#34;link&#34; href=&#34;https://dl.google.com/android/repository/platform-tools_r31.0.0-windows.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ADB&lt;/a&gt;&lt;br&gt;
用于设置Q7从TF卡启动。&lt;/li&gt;
&lt;li&gt;下载&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/thread-4076037-1-1.html&#34;  title=&#34;多盒OP固件-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;55+、55+O S905x3、S922x、贝壳云、我家云、微加云等OP固件&amp;rdquo;&lt;/a&gt;文中所附的固件包。&lt;br&gt;
用的是目录&amp;quot;N1-Openwrt_U盘直刷包&amp;quot;下的最新固件包, 当前是:&lt;br&gt;
&amp;ldquo;openwrt_s905d_n1_R21.2.1_k5.4.105-flippy-55+o.7z&amp;rdquo;&lt;br&gt;
解开压缩文件, 其中&amp;quot;openwrt_s905d_n1_R21.2.1_k5.4.105-flippy-55+o.img&amp;quot;就是要用的固件包。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;刷机流程&#34;&gt;刷机流程&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;破解Q7&lt;br&gt;
按照&lt;a class=&#34;link&#34; href=&#34;https://jimway71.github.io/p/%e8%81%94%e9%80%9a%e6%95%b0%e7%a0%81%e8%a7%86%e8%ae%afq7%e7%94%b5%e8%a7%86%e7%9b%92%e5%ad%90%e5%88%b7%e6%9c%ba%e6%88%90%e5%8a%9f-%e4%bd%86%e8%bf%99q7%e7%9b%92%e5%ad%90%e6%98%af%e7%9c%9f%e7%9a%84%e5%9e%83%e5%9c%be/&#34;  title=&#34;Q7盒子垃圾-&amp;gt;&#34;
    &gt;&amp;ldquo;联通(数码视讯)Q7电视盒子刷机成功, 但这Q7盒子是真的垃圾!&amp;rdquo;&lt;/a&gt;帖子的做法, 破解Q7.&lt;br&gt;
按&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/&#34;  title=&#34;恩山-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;恩山论坛&lt;/a&gt;的&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-593965.html&#34;  title=&#34;len_-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Len_&lt;/a&gt;大侠的说法, &amp;ldquo;Q7需要刷过第三方固件才能确定能从卡和U盘启动&amp;rdquo;, 而Q7原厂固件无法确定能做到。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;del&gt;打开Q7的USB调试功能。(大概操作, 跟安卓手机也差不多)&lt;/del&gt;&lt;br&gt;
&lt;del&gt;正常打开Q7, 按正常方式使用遥控器操作, 进入&amp;quot;设置&amp;quot;(类似安卓的设置界面), 找到&amp;quot;关于设备&amp;quot;-&amp;ldquo;版本号&amp;rdquo;, 连续点击版本号很多次, 可能是十次, 也可能是七次, 试吧&amp;hellip;&lt;/del&gt;&lt;br&gt;
&lt;del&gt;然后退回&amp;quot;设置&amp;quot;界面, 就出现&amp;quot;开发者选项&amp;quot;, 进去就可以找到&amp;quot;USB调试&amp;quot;, 然后打开&amp;quot;USB调试&amp;quot;。&lt;/del&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;制作启动TF卡&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;选择镜像文件&lt;br&gt;
按&lt;a class=&#34;link&#34; href=&#34;https://www.right.com.cn/forum/space-uid-593965.html&#34;  title=&#34;len_-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Len_&lt;/a&gt;大侠的说法, 在目录&amp;quot;N1-Openwrt_U盘直刷包&amp;quot;下的包都可以刷, 选了最新的55+o版本, 文件是&amp;quot;openwrt_s905d_n1_R21.2.1_k5.4.105-flippy-55+o.7z&amp;quot;, 解压出&amp;quot;openwrt_s905d_n1_R21.2.1_k5.4.105-flippy-55+o.img&amp;quot;文件。&lt;/li&gt;
&lt;li&gt;用镜像写入U盘工具&lt;a class=&#34;link&#34; href=&#34;https://www.alexpage.de/download/usbit/usbit.zip&#34;  title=&#34;USB Image Tool-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;USB Image Tool&lt;/a&gt;把img文件写到TF卡里&lt;/li&gt;
&lt;li&gt;修改TF卡根目录下的&amp;quot;uEnv.txt&amp;quot;文件, 如下图:&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/27-q7-01.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;uEnv.txt&#34;
	
	
&gt;
即FDT要改为p212这个dtb文件(这个文件要确认在tf卡相应的目录下存在)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;del&gt;把TF卡插入到Q7的TF卡槽中, 使用ADB工具, 设置Q7从TF卡启动&lt;/del&gt;&lt;br&gt;
&lt;del&gt;连接Q7:&lt;/del&gt;~~&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;del&gt;# adb connect Q7地址&lt;/del&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;del&gt;查看连接状态:&lt;/del&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;del&gt;# adb devices&lt;/del&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;del&gt;重启Q7, 并设置成用cf卡或U盘等外围存储设备启动&lt;/del&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;del&gt;# adb shell reboot update&lt;/del&gt;&lt;br&gt;
&lt;del&gt;(上面这个命令需要确认)&lt;/del&gt;&lt;br&gt;
&lt;del&gt;正常的话, 会重新从TF卡启动系统。&lt;/del&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;从做好的TF卡启动盒子&lt;br&gt;
正常启动盒子, 进入电视盒子界面.&lt;br&gt;
下载&lt;a class=&#34;link&#34; href=&#34;https://apkpure.com/reboot-to-libreelec/me.thomastv.rebootupdate&#34;  title=&#34;Reboot to LibreELEC-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;Reboot to LibreELEC&amp;rdquo;&lt;/a&gt;, 这个apk设置系统首先从外部存储设备启动, 比如TF卡, 或者U盘.&lt;br&gt;
在盒子的界面上, 安装&lt;a class=&#34;link&#34; href=&#34;https://apkpure.com/reboot-to-libreelec/me.thomastv.rebootupdate&#34;  title=&#34;Reboot to LibreELEC-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;Reboot to LibreELEC&amp;rdquo;&lt;/a&gt;这个应用, 安装完成后运行这个APK, 并选择&amp;quot;ok&amp;quot;&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/27-q7-02.jpg&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;uEnv.txt&#34;
	
	
&gt;&lt;br&gt;
正常情况下, 如果有外置存储设备可以启动, 则从外置存储设备启动,否则从内部的存储设备启动.&lt;br&gt;
比如, 插入了刷好固件的TF卡, 就会从TF卡启动, 运行openwrt; 如果没有, 就正常启动, 进入电视盒子界面.&lt;br&gt;
&lt;u&gt;但是, Q7这个盒子比较奇葩, 如果设置好了能从TF卡启动, 那么就只能从TF卡启动, 不插TF卡时会死在第一屏界面.&lt;/u&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把系统安装到内部存储&lt;br&gt;
系统里有提供安装工具(shell), 是/root/install-to-emmc.sh&lt;br&gt;
如果有需要可以使用这个shell将系统装入内部存储&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;完成后启动openwrt&#34;&gt;完成后启动&lt;a class=&#34;link&#34; href=&#34;https://openwrt.org/&#34;  title=&#34;Openwrt-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Openwrt&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;使用tf卡启动, 成功地在Q7上运行了&lt;a class=&#34;link&#34; href=&#34;https://openwrt.org/&#34;  title=&#34;Openwrt-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;openwrt&lt;/a&gt;.&lt;br&gt;
openwrt缺省地址: 192.168.1.1, 缺省用户/密码: root/password&lt;br&gt;
但是:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;不能设置wifi&lt;br&gt;
可能是无线网卡不能正常驱动。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;使用图片&#34;&gt;使用图片&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://jimway71.github.io/img/27-q7-03.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;uEnv.txt&#34;
	
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;补充: 关于移动魔百盒R3300L(红)&lt;br&gt;
可以使用给Q7做的启动盘(TF卡)启动.&lt;br&gt;
用&lt;a class=&#34;link&#34; href=&#34;https://apkpure.com/reboot-to-libreelec/me.thomastv.rebootupdate&#34;  title=&#34;Reboot to LibreELEC-&amp;gt;&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;ldquo;Reboot to LibreELEC&amp;rdquo;&lt;/a&gt;可以正常工作, 插卡从卡启动, 不插卡正常启动.&lt;br&gt;
用CoreMark测试分数比Q7略低, 差得并不多.&lt;br&gt;
R3300L和Q7内部配置基本一致，甚至包括芯片组:
&lt;ul&gt;
&lt;li&gt;相同的CPU,&lt;/li&gt;
&lt;li&gt;相同的wifi芯片,&lt;/li&gt;
&lt;li&gt;相同的内存+存储配置,&lt;/li&gt;
&lt;li&gt;壳子都是卡扣结构,&lt;/li&gt;
&lt;li&gt;都能从usb口给盒子供电，不受电源开关控制,&lt;/li&gt;
&lt;li&gt;都有tf卡槽。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;其他&#34;&gt;其他&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;关于TF卡的大小&lt;br&gt;
前面说过, TF卡要&amp;gt;4G。&lt;br&gt;
但是, 从使用情况看，TF卡仅有不到1G的空间分给了Openwrt要用的两个分区, 其中有一个是启动分区, 其它的空间都是空的。&lt;br&gt;
所以, 估计1G的TF卡也都能用。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关于Q7的供电&lt;br&gt;
帖子&lt;a class=&#34;link&#34; href=&#34;https://jimway71.github.io/p/%e8%81%94%e9%80%9a%e6%95%b0%e7%a0%81%e8%a7%86%e8%ae%afq7%e7%94%b5%e8%a7%86%e7%9b%92%e5%ad%90%e5%88%b7%e6%9c%ba%e6%88%90%e5%8a%9f-%e4%bd%86%e8%bf%99q7%e7%9b%92%e5%ad%90%e6%98%af%e7%9c%9f%e7%9a%84%e5%9e%83%e5%9c%be/&#34;  title=&#34;Q7盒子垃圾-&amp;gt;&#34;
    &gt;&amp;ldquo;联通(数码视讯)Q7电视盒子刷机成功, 但这Q7盒子是真的垃圾!&amp;rdquo;&lt;/a&gt;里面说过, Q7可以直接用USB端口的供电启动, 所以可以从别的设备的USB给Q7供电, 至少还可以少占一个电源插座。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CPUMark 测速&lt;br&gt;
命令如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# /etc/coremark.sh&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;测速完成后, 在Luci管理界面, &amp;ldquo;状态&amp;rdquo;-&amp;ldquo;概览&amp;quot;里可以看到CpuMark值&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;再补充---关于网络共享服务&#34;&gt;再补充 - 关于网络共享服务&lt;/h2&gt;
&lt;p&gt;Openwrt中有提供多种网络存储服务, 包括Samba/NFS/miniDLNA/可道云/微力同步等多种相关功能。&lt;br&gt;
在给Q7刷Openwrt后, 还通过配置Samba+miniDLNA, 设置了一个简单的网络共享服务+多媒体服务&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;设置Sabmba服务&lt;br&gt;
操作如下:&lt;br&gt;
Luci界面-网络存储-&amp;ldquo;Samba&amp;rdquo;-&amp;ldquo;编辑模板&amp;quot;里改配置文件(没搞懂原因), 关掉&amp;quot;invalid users = root&amp;quot;这行&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;## set invalid users&lt;br&gt;
#invalid users = root&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;设置共享目录&lt;br&gt;
设置如图:&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/27-q7-04.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Samba设置&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;现象:&lt;br&gt;
用手机上有EsExplorer连接上后(当前也就只有手机能连上), 看不到共享的文件目录&lt;br&gt;
原因: 管理界面里共享目录的设置并没有生效, 还是需要手动修改配置文件&amp;rdquo;/etc/samba/smb.conf&amp;quot;进行设置(已确认重启后有效)&lt;br&gt;
但是, &amp;ldquo;Samba&amp;rdquo;-&amp;ldquo;编辑模板&amp;quot;却是有效的, 而且进入linux界面操作, 直接修改/etc/samba/smb.conf的相应内容却无效!~~~ 必须使用管理界面的&amp;quot;编译模板&amp;quot;进行修改!&lt;br&gt;
即: 改模板必须在&amp;quot;Samba&amp;rdquo;-&amp;ldquo;编辑模板&amp;quot;里, 改共享目录配置必须直接改&amp;rdquo;/etc/samba/smb.conf&amp;quot;文件&lt;br&gt;
处理:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# vim /etc/samba/smb.conf&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在文件最后面增加如下配置:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[Udisk]&lt;br&gt;
path = /mnt/mmcblk1p3&lt;br&gt;
create mask = 0777&lt;br&gt;
read only = no&lt;br&gt;
guest ok = yes&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如图所示:&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/27-q7-05.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Samba设置&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;然后重启samba服务:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# service samba4 restart&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;用smbclient查看共享的情况:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# smbclient -L 192.168.1.206&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;会看到已经成功共享, 如图:&lt;br&gt;
&lt;img src=&#34;https://jimway71.github.io/img/27-q7-06.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Samba设置&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;注意:&lt;br&gt;
还需要对共享出的根目录权限做设置, 才能有读写全部权限&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;# chmod 0777 /mnt/mmcblk1p3&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;设置miniDLNA&lt;br&gt;
在X信电视上发现X信的媒体中心支持DLNA, 而Q7上的Openwrt里, &amp;ldquo;网络存储&amp;quot;下是有miniDLNA服务, 设置比较简单, 基本上是设置下目录, 打开功能就可以了。&lt;br&gt;
经过测试, 在X信电视上用自带的媒体中心可以播放视频、音频、图片等多种媒体, 还可以关屏幕播放mp3音乐。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;But&amp;hellip;到最后, 重启Q7后, openwrt的Luci界面出错了, 进不了管理界面, 就此, 折腾Q7告一段落。
总结: Openwrt的SAMBA功能大致能用, miniDLNA功能也没问题, 都可以用。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>WSL下编译LEDE的openwrt, 用于斐讯K2</title>
        <link>https://jimway71.github.io/p/wsl%E4%B8%8B%E7%BC%96%E8%AF%91lede%E7%9A%84openwrt-%E7%94%A8%E4%BA%8E%E6%96%90%E8%AE%AFk2/</link>
        <pubDate>Mon, 01 Jun 2020 01:06:16 +0800</pubDate>
        
        <guid>https://jimway71.github.io/p/wsl%E4%B8%8B%E7%BC%96%E8%AF%91lede%E7%9A%84openwrt-%E7%94%A8%E4%BA%8E%E6%96%90%E8%AE%AFk2/</guid>
        <description>&lt;img src="https://jimway71.github.io/wallpaper/wallpaper-22.jpg" alt="Featured image of post WSL下编译LEDE的openwrt, 用于斐讯K2" /&gt;&lt;p&gt;2020.6.1&lt;/p&gt;
&lt;h3 id=&#34;openwrt编译命令汇总&#34;&gt;Openwrt编译命令汇总:&lt;/h3&gt;
&lt;p&gt;开始编译:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo apt-get update  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo apt-get -y install build-essential asciidoc binutils bzip2 gawk gettext git libncurses5-dev libz-dev patch python3.5 python2.7 unzip zlib1g-dev lib32gcc1 libc6-dev-i386 subversion flex uglifyjs git-core gcc-multilib p7zip p7zip-full msmtp libssl-dev texinfo libglib2.0-dev xmlto qemu-utils upx libelf-dev autoconf automake libtool autopoint device-tree-compiler g++-multilib antlr3 gperf wget  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ git clone https://github.com/coolsnowwolf/lede  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ./lede  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ vim feeds.conf.default  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ ./scripts/feeds update -a  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ ./scripts/feeds install -a  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ make menuconfig  
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在make menuconfig中:&lt;br&gt;
选择: MediaTek Ralink MIPS / MT7620 based boards /Phicomm PSG128 rev.Ax&amp;quot;&lt;br&gt;
选择: Luci _ Application _ SSR PLUS&amp;hellip;&amp;quot;&lt;br&gt;
说明: 斐讯K2路由器, CPU型号为MT7620, 芯片架构为MIPS, 路由器型号为PSG1218 rev.Ax; K1 是 PSG1208,K2 是 PSG1218 rev.Ax, K2C是PSG1218 rev.Bx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Target system -&amp;gt; MediaTek Ralink MIPS  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Subtarget -&amp;gt; MT7620 based boards  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Target Profile -&amp;gt; Phicomm PSG128 rev.Ax  
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;继续编译:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ make -j8 download &lt;span class=&#34;nv&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;s  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ make -j15 &lt;span class=&#34;nv&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;s  
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;由于空间不够，luci-&amp;gt;application留下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;accesscontrol  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- adbyby-plus  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;arpbind  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;autoreboot  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- ddns  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;firewall  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;flowoffload  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- nlbwmon 流量监控  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ramfree  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ssr_plus + trojan  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;upnp  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;(因为不能保存配置, 再去掉IPV6支持)  
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;不知道为什么, 内网的网段(ip)不能成功修改, 每次改过后, 路由就不能保存(或者会丢失)修改的内容: 需要在编译的时候就改掉这个地址。&lt;br&gt;
位于: ./package/base-files/files/bin/config_generate&lt;br&gt;
在make menuconfig完成后修改&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关于用WSL代替虚拟机运行Ubuntu:&lt;br&gt;
当前WSL上Ubuntu最早版本是18.04LTS(16.04LTS已经没有了)，最新的是20.04LTS&lt;br&gt;
用WSL比较简单, 不用费劲去安装, 但移动虚拟机会很麻烦。这个问题可以参考:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在系统重置或重新安装之前，如何备份（WSL）Windows 10的Linux子系统: &lt;br&gt;
Windows 10 v1903 包含内置的WSL导出/导入命令。具体来说，wsl &amp;ndash;export会产生tar和wsl &amp;ndash;import，并会导入先前导出的tar。然后，您可以在计算机之间移动此文件。 您还可以使用指定stdin / stdout -，这应允许您直接转移到另一台计算机并使用远程shell（如）导入ssh。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;错误处理&#34;&gt;错误处理:&lt;/h3&gt;
&lt;p&gt;1 sudo apt-get install gcc-multilib g++-multilib&lt;br&gt;
原因：type_traits:38:10: fatal error: bits/c++config.h: No such file or directory&lt;br&gt;
参考: &lt;a class=&#34;link&#34; href=&#34;https://stackoverflow.com/questions/4643197/missing-include-bits-cconfig-h-when-cross-compiling-64-bit-program-on-32-bit&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://stackoverflow.com/questions/4643197/missing-include-bits-cconfig-h-when-cross-compiling-64-bit-program-on-32-bit&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2 sudo apt install qtchooser&lt;br&gt;
原因: File &amp;ldquo;/usr/lib/python2.7/subprocess.py&amp;rdquo;, line 1047, in _execute_child&lt;br&gt;
参考: &lt;a class=&#34;link&#34; href=&#34;https://github.com/kovidgoyal/build-calibre/issues/9&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/kovidgoyal/build-calibre/issues/9&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;编译时长记录&#34;&gt;编译时长记录:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;在Google云主机(e2-standard-8（8 个 vCPU，32 GB 内存), 30GSSD硬盘, Ubuntu 16.04)上完成，最后编译用了7个线程，总共用时不到1小时&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;参考&#34;&gt;参考:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://mianao.info/2020/05/05/%E7%BC%96%E8%AF%91%E6%9B%B4%E6%96%B0OpenWrt-PassWall%E5%92%8CSSR-plus%E6%8F%92%E4%BB%B6&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;编译更新OpenWrt PassWall和SSR-plus插件&lt;/a&gt; From &lt;a class=&#34;link&#34; href=&#34;https://mianao.info/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;mianao&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/coolsnowwolf/lede&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Lean 的 Openwrt 源码仓库&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        
    </channel>
</rss>
